{"config":{"indexing":"full","lang":["en","ja"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"deck-mining/","text":"Home Still a draft. Introduction The bulk of this guide will be what I tried on default SteamOS. If you're planning to go the Windows route, the tips and controller section of the guide might still be helpful. If you are planning on playing a lot of VN's that is not Steam Deck certified or native Linux, and you don't have the patience to fiddle with settings to get those VN's working right, you might want to consider using Windows. Check out dual-booting Windows, or using a virtual machine in SteamOS desktop mode. See Running Windows on the Steam Deck for more info. Typical lookup and mining workflow Browser texthook page, Yomichan, Anki Deck-specific tweaks TODO: zoom levels, etc","title":"Introduction"},{"location":"deck-mining/#home","text":"Still a draft.","title":"Home"},{"location":"deck-mining/#introduction","text":"The bulk of this guide will be what I tried on default SteamOS. If you're planning to go the Windows route, the tips and controller section of the guide might still be helpful. If you are planning on playing a lot of VN's that is not Steam Deck certified or native Linux, and you don't have the patience to fiddle with settings to get those VN's working right, you might want to consider using Windows. Check out dual-booting Windows, or using a virtual machine in SteamOS desktop mode. See Running Windows on the Steam Deck for more info.","title":"Introduction"},{"location":"deck-mining/#typical-lookup-and-mining-workflow","text":"Browser texthook page, Yomichan, Anki","title":"Typical lookup and mining workflow"},{"location":"deck-mining/#deck-specific-tweaks","text":"TODO: zoom levels, etc","title":"Deck-specific tweaks"},{"location":"deck-mining/OCR/","text":"OCR :heavy_exclamation_mark: CURRENTLY DOES NOT WORK. Steps below are for reference only of what I've tried. manga_ocr currently does not work due to missing xclip or wl-paste. It used to work but looks like some SteamOS update broke it. Also I'm having trouble installing owocr in a Python venv, but I need venv to install OCR services like Google Lens or EasyOCR, so I'm currently stuck. Just for my reference, does not work I'll be going through [OwOcr](https://github.com/AuroraWright/owocr) here. If you're comfortable with installing software through pacman, you can also check out YomiNinja. ## Install OwOcr 1. Create a Python virtual env (need this for manga_ocr on the Steam Deck, or it'll complain about externally managed environment and possibility of breaking the OS if you try to override it). Open Konsole and type or paste in following: python3 -m venv ocr source ocr/bin/activate 2. install pip python -m ensurepip --upgrade This will install pip into ~/.local/bin. We need to add this to PATH as well. 3. edit `~/.bashrc` in something like `Kate` or `vim`, add this to the end of the file: if [ -d \" $HOME /.local/bin\" ] ; then PATH = \" $HOME /.local/bin: $PATH \" fi 4. Test it's working: ~/.local/bin/pip -V 5. Now we can install owocr: pip install owocr 6. And install manga_ocr: pip install manga_ocr Reference: (https://www.reddit.com/r/SteamDeck/comments/x4ct1r/how_do_i_do_a_pip3_install/) ## Using OwOcr `To be added` Note: I did not manage to try it, but it may be possible to install python and the ocr tools properly through podman and/or distrobox without having to unlock the Deck and use pac-man. If you manage to get it working, feel free to share!","title":"Using OCR"},{"location":"deck-mining/OCR/#ocr","text":":heavy_exclamation_mark: CURRENTLY DOES NOT WORK. Steps below are for reference only of what I've tried. manga_ocr currently does not work due to missing xclip or wl-paste. It used to work but looks like some SteamOS update broke it. Also I'm having trouble installing owocr in a Python venv, but I need venv to install OCR services like Google Lens or EasyOCR, so I'm currently stuck. Just for my reference, does not work I'll be going through [OwOcr](https://github.com/AuroraWright/owocr) here. If you're comfortable with installing software through pacman, you can also check out YomiNinja. ## Install OwOcr 1. Create a Python virtual env (need this for manga_ocr on the Steam Deck, or it'll complain about externally managed environment and possibility of breaking the OS if you try to override it). Open Konsole and type or paste in following: python3 -m venv ocr source ocr/bin/activate 2. install pip python -m ensurepip --upgrade This will install pip into ~/.local/bin. We need to add this to PATH as well. 3. edit `~/.bashrc` in something like `Kate` or `vim`, add this to the end of the file: if [ -d \" $HOME /.local/bin\" ] ; then PATH = \" $HOME /.local/bin: $PATH \" fi 4. Test it's working: ~/.local/bin/pip -V 5. Now we can install owocr: pip install owocr 6. And install manga_ocr: pip install manga_ocr Reference: (https://www.reddit.com/r/SteamDeck/comments/x4ct1r/how_do_i_do_a_pip3_install/) ## Using OwOcr `To be added` Note: I did not manage to try it, but it may be possible to install python and the ocr tools properly through podman and/or distrobox without having to unlock the Deck and use pac-man. If you manage to get it working, feel free to share!","title":"OCR"},{"location":"deck-mining/acknowledgements/","text":"Acknowledgements I would like to thank the following people who made this guide possible: - Xelieu who made the lazy guide which I based my Yomitan and mining setup on. Also thanks for introducing me to mkdocs and having the lazy guide page source code available for reference. - xythh who I got the code to add screenshot and audio to Anki on Linux, I only needed to make minor edits to make them work on the Deck. - Nerdnest (on YouTube) who made really good controller mapping tutorials and which I hope to learn and use more in the future. - Visual Novel Wiki for the resources on getting VNs to work on Linux. - TheMoeWay community, from which I first learnt about most of the tools involved and also gave some help when I had technical questions. And you, dear reader who've made it to this page, thank you. I hope there's been something useful in here for you, and feel free to reach out if you'd like to contribute to the guide or share your experiences on Japanese learning with the Steam Deck. Contact I can be reached as aka_baka on discord, or you can create pull requests for this repo. Thank you!","title":"Acknowledgements"},{"location":"deck-mining/acknowledgements/#acknowledgements","text":"I would like to thank the following people who made this guide possible: - Xelieu who made the lazy guide which I based my Yomitan and mining setup on. Also thanks for introducing me to mkdocs and having the lazy guide page source code available for reference. - xythh who I got the code to add screenshot and audio to Anki on Linux, I only needed to make minor edits to make them work on the Deck. - Nerdnest (on YouTube) who made really good controller mapping tutorials and which I hope to learn and use more in the future. - Visual Novel Wiki for the resources on getting VNs to work on Linux. - TheMoeWay community, from which I first learnt about most of the tools involved and also gave some help when I had technical questions. And you, dear reader who've made it to this page, thank you. I hope there's been something useful in here for you, and feel free to reach out if you'd like to contribute to the guide or share your experiences on Japanese learning with the Steam Deck.","title":"Acknowledgements"},{"location":"deck-mining/acknowledgements/#contact","text":"I can be reached as aka_baka on discord, or you can create pull requests for this repo. Thank you!","title":"Contact"},{"location":"deck-mining/beforePlaying/","text":"Getting Things Ready Before Playing Things you will want to launch every time you want to do immersion learning gaming: 1. Make sure your desktop controller mappings support Alt-Tab, and optionally hotkeys to save cards, screenshots and audio to Anki. (only need to do this once. See the section on controller mapping for more details.) 2. Browser and texthook page. Make sure Yomitan is enabled 3. Anki (if you're mining, or using offline audio with it) I personally just launch everything manually myself, but you could write a short bash script to start them all if you want. It's time to then launch the game and hook it. Follow the relevant parts in the following sections, you'll only need to do one type of hooking for a game.","title":"Getting Things Ready Before Playing"},{"location":"deck-mining/beforePlaying/#getting-things-ready-before-playing","text":"Things you will want to launch every time you want to do immersion learning gaming: 1. Make sure your desktop controller mappings support Alt-Tab, and optionally hotkeys to save cards, screenshots and audio to Anki. (only need to do this once. See the section on controller mapping for more details.) 2. Browser and texthook page. Make sure Yomitan is enabled 3. Anki (if you're mining, or using offline audio with it) I personally just launch everything manually myself, but you could write a short bash script to start them all if you want. It's time to then launch the game and hook it. Follow the relevant parts in the following sections, you'll only need to do one type of hooking for a game.","title":"Getting Things Ready Before Playing"},{"location":"deck-mining/controller/","text":"Controller config Please learn how to change the controller config of games in Steam separately, I won't be covering that in this guide. Desktop vs game config Game configs are per-game, and are active when the game is in focus. \\ Desktop config is active when the game is not in focus. As such, you'll want to ensure Alt+Tab is mapped for both configs, otherwise you may be able to tab away from the game but not back, or vice-versa. Tips For some reason left Alt+Tab doesn't work for me to tab away from game. But Right Alt+Tab does.\\ Personally I map Right Alt to L4, and Tab to R4. This way, I can keep holding Alt while tabbing a few times to swap between multiple windows, instead of just toggling between the 2 most recent. If you're using SteamTinkerLaunch, you'll want to ensure something (I suggest touchpad) is mapped to mouse movement and click in the game config so that you can click on the menu. Steam + x will bring up the on-screen keyboard. For VNs, you'll likely want to map these actions if it's not already in your config: - replay audio - bring up backlog - quick save, quick load Templates (WIP) It should be possible to save a config as a template to make it easier to set up for other games, but I have not done this yet. Advanced mappings Examples of more fancy things you can do: - set up different layers so the same button does different things when another button or the touchpad is pressed. - create radial menus with the touchpad or stick - create button menus with the touchpad These are useful if the game you're playing is already using the majority of buttons and you want to map more actions for Anki mining. You can learn more from video tutorials, eg. NerdNest's excellent one on action layers .","title":"Controller Mapping"},{"location":"deck-mining/controller/#controller-config","text":"Please learn how to change the controller config of games in Steam separately, I won't be covering that in this guide.","title":"Controller config"},{"location":"deck-mining/controller/#desktop-vs-game-config","text":"Game configs are per-game, and are active when the game is in focus. \\ Desktop config is active when the game is not in focus. As such, you'll want to ensure Alt+Tab is mapped for both configs, otherwise you may be able to tab away from the game but not back, or vice-versa.","title":"Desktop vs game config"},{"location":"deck-mining/controller/#tips","text":"For some reason left Alt+Tab doesn't work for me to tab away from game. But Right Alt+Tab does.\\ Personally I map Right Alt to L4, and Tab to R4. This way, I can keep holding Alt while tabbing a few times to swap between multiple windows, instead of just toggling between the 2 most recent. If you're using SteamTinkerLaunch, you'll want to ensure something (I suggest touchpad) is mapped to mouse movement and click in the game config so that you can click on the menu. Steam + x will bring up the on-screen keyboard. For VNs, you'll likely want to map these actions if it's not already in your config: - replay audio - bring up backlog - quick save, quick load","title":"Tips"},{"location":"deck-mining/controller/#templates","text":"(WIP) It should be possible to save a config as a template to make it easier to set up for other games, but I have not done this yet.","title":"Templates"},{"location":"deck-mining/controller/#advanced-mappings","text":"Examples of more fancy things you can do: - set up different layers so the same button does different things when another button or the touchpad is pressed. - create radial menus with the touchpad or stick - create button menus with the touchpad These are useful if the game you're playing is already using the majority of buttons and you want to map more actions for Anki mining. You can learn more from video tutorials, eg. NerdNest's excellent one on action layers .","title":"Advanced mappings"},{"location":"deck-mining/demos/","text":"Demos Yakuza 0 + SteamTinkerLaunch + Windows Agent Clannad + Yuzu + Linux Agent Tsuyuchiru + Lutris + Textractor Zero Time Dilemma + owocr (planned) Mining to Anki Bonus: YomiNinja on Windows (planned) Trails of Cold Steel + Agent on Windows","title":"Demos"},{"location":"deck-mining/demos/#demos","text":"","title":"Demos"},{"location":"deck-mining/demos/#yakuza-0-steamtinkerlaunch-windows-agent","text":"","title":"Yakuza 0 + SteamTinkerLaunch + Windows Agent"},{"location":"deck-mining/demos/#clannad-yuzu-linux-agent","text":"","title":"Clannad + Yuzu + Linux Agent"},{"location":"deck-mining/demos/#tsuyuchiru-lutris-textractor","text":"","title":"Tsuyuchiru + Lutris + Textractor"},{"location":"deck-mining/demos/#zero-time-dilemma-owocr-planned","text":"","title":"Zero Time Dilemma + owocr (planned)"},{"location":"deck-mining/demos/#mining-to-anki","text":"","title":"Mining to Anki"},{"location":"deck-mining/demos/#bonus-yomininja-on-windows-planned","text":"","title":"Bonus: YomiNinja on Windows (planned)"},{"location":"deck-mining/demos/#trails-of-cold-steel-agent-on-windows","text":"","title":"Trails of Cold Steel + Agent on Windows"},{"location":"deck-mining/hookEmuDeck/","text":"Hooking Linux Games or Emulators This is the most straightforward. Just launch your game, then launch Textractor or Agent yourself. For emulators, I've only tested Yuzu. Linux version of Agent works with it. I have not tried other emulators, not sure if Agent or Textractor would be able to work with them. (If you've tried, let me know your experience!)","title":"Hooking Linux Games or Emulators"},{"location":"deck-mining/hookEmuDeck/#hooking-linux-games-or-emulators","text":"This is the most straightforward. Just launch your game, then launch Textractor or Agent yourself. For emulators, I've only tested Yuzu. Linux version of Agent works with it. I have not tried other emulators, not sure if Agent or Textractor would be able to work with them. (If you've tried, let me know your experience!)","title":"Hooking Linux Games or Emulators"},{"location":"deck-mining/hookLutrisGames/","text":"Hooking Lutris or Other Proton Launcher Games I assume you're familiar with how to get visual novels running using Lutris or Bottles. I personally refer to Visual Novel wiki . If you're unfamiliar with wine/proton, a very simple (and not very accurate, but good enough for our usage) way to think of it is having mini virtual Windows PC on every \"wine/proton prefix\". So the challenge is to ensure Textractor or Agent will launch in the same prefix (mini virtual Windows PC), or it won't be able to find your game. As long as you have a working prefix for your game, you can use the same prefix to launch Textractor or Agent, and everything else will work the same like hooking a Steam game. Note: unfortunately the VN wiki is bugging out and not displaying images as of the time of this writing, so you might want to check archived pages at the Internet Wayback Machine instead.","title":"Hooking Lutris or Other proton Launcher Games"},{"location":"deck-mining/hookLutrisGames/#hooking-lutris-or-other-proton-launcher-games","text":"I assume you're familiar with how to get visual novels running using Lutris or Bottles. I personally refer to Visual Novel wiki . If you're unfamiliar with wine/proton, a very simple (and not very accurate, but good enough for our usage) way to think of it is having mini virtual Windows PC on every \"wine/proton prefix\". So the challenge is to ensure Textractor or Agent will launch in the same prefix (mini virtual Windows PC), or it won't be able to find your game. As long as you have a working prefix for your game, you can use the same prefix to launch Textractor or Agent, and everything else will work the same like hooking a Steam game. Note: unfortunately the VN wiki is bugging out and not displaying images as of the time of this writing, so you might want to check archived pages at the Internet Wayback Machine instead.","title":"Hooking Lutris or Other Proton Launcher Games"},{"location":"deck-mining/hookSteamGames/","text":"Hooking Steam Games How to hook Steam games (or games you've added shortcut to Steam and launching with Steam). We'll be using SteamTinkerLaunch to fork Textractor/Agent when the game starts. 1. download SteamTinkerLaunch 2. follow the instructions at SteamTinkerLaunch page to use it with your game, either as a Compatibility Tool (if the game is not native Linux and is running on Proton), or as a Launch Option (if the game is native Linux). 3. this page has a demo of adding as a compatibility tool 4. launch your game. By default the SteamTinkerLaunch menu will display for 2 seconds. Click on MAIN MENU before it disappears. (tip: the controller mapping for your game will be used, so you might find pressing the right trigger doesn't do a mouse click. You can use the touch screen instead, or else map something to left click in your game controller mappings.) The time this menu displays can be customized in SteamTinkerLaunch settings. 5. Click on GAME MENU . 7. In the game menu, tick Fork custom command , and click on the box beside Custom command . Select the program you need (Textractor or Agent) from where you saved them. 9. click on SAVE AND PLAY . Your game will launch together with the the program you put in #5. 10. hook the game with Textractor or Agent. (you may want to customize your game mappings so you can use trackpad as mouse and click. Especially for Agent where you'll need to drag & drop the crosshair.) 11. play the game, and Alt-Tab to the texthook page when you want to look up words, then Alt-Tab back. Enjoy! 12. optional: once you're sure you won't want to change anything in SteamTinkerLaunch for that game, you can disable the display before the game launches. Note: SteamTinkerLaunch will always try to update itself before launching, so it'll take a bit more time to launch your games.","title":"Hooking Steam Games"},{"location":"deck-mining/hookSteamGames/#hooking-steam-games","text":"How to hook Steam games (or games you've added shortcut to Steam and launching with Steam). We'll be using SteamTinkerLaunch to fork Textractor/Agent when the game starts. 1. download SteamTinkerLaunch 2. follow the instructions at SteamTinkerLaunch page to use it with your game, either as a Compatibility Tool (if the game is not native Linux and is running on Proton), or as a Launch Option (if the game is native Linux). 3. this page has a demo of adding as a compatibility tool 4. launch your game. By default the SteamTinkerLaunch menu will display for 2 seconds. Click on MAIN MENU before it disappears. (tip: the controller mapping for your game will be used, so you might find pressing the right trigger doesn't do a mouse click. You can use the touch screen instead, or else map something to left click in your game controller mappings.) The time this menu displays can be customized in SteamTinkerLaunch settings. 5. Click on GAME MENU . 7. In the game menu, tick Fork custom command , and click on the box beside Custom command . Select the program you need (Textractor or Agent) from where you saved them. 9. click on SAVE AND PLAY . Your game will launch together with the the program you put in #5. 10. hook the game with Textractor or Agent. (you may want to customize your game mappings so you can use trackpad as mouse and click. Especially for Agent where you'll need to drag & drop the crosshair.) 11. play the game, and Alt-Tab to the texthook page when you want to look up words, then Alt-Tab back. Enjoy! 12. optional: once you're sure you won't want to change anything in SteamTinkerLaunch for that game, you can disable the display before the game launches. Note: SteamTinkerLaunch will always try to update itself before launching, so it'll take a bit more time to launch your games.","title":"Hooking Steam Games"},{"location":"deck-mining/mining/","text":"Mining How to save screenshots to Anki Save this shell script to your Deck, keep it somewhere you'll remember. Calling this script will capture the active window and save it to the latest Anki note, and display a notification (depending on your notification settings, you may not see it when in-game). With thanks to Xythh whom I got the code snippet from and just made minor edits to work on the Deck. ss_window.sh #!/bin/sh ### capture screnshot with spectacle #ss_dir=\"/home/deck/Pictures/Screenshots/for_anki\" time = $( date +%Y-%m-%d-%H-%M-%S ) #tmp_file=${ss_dir}/${time} tmp_file = \"/home/deck/.var/app/net.ankiweb.Anki/ $time \" spectacle --background --activewindow --nonotify --output $tmp_file .jpg ### import to anki. Code taken from https://gist.github.com/xythh/96796571baa850783a0b49f4d325e5b2 with minor edits ankiConnectPort = \"8765\" pictureField = \"Picture\" # This gets your notes marked as new and returns the newest one. newestNoteId = $( curl -s localhost: $ankiConnectPort -X POST -d '{\"action\": \"findNotes\", \"version\": 6, \"params\": { \"query\": \"is:new\"}}' | jq '.result[-1]' ) # if anki connect is running it will return your latest note id, and the following code will run, if anki connect is not running a notification pops up. if [ \" $newestNoteId \" ! = \"\" ] ; then curl -s localhost: $ankiConnectPort -X POST -d '{ \"action\": \"updateNoteFields\", \"version\": 6, \"params\": { \"note\": { \"id\": ' \" $newestNoteId \" ', \"fields\": { \"' $pictureField '\": \"\" }, \"picture\": [{ \"path\": \"' \" $tmp_file \" '.jpg\", \"filename\": \"paste-' \" $time \" '.jpg\", \"fields\": [ \"' $pictureField '\" ] }] } } }' notify-send \"Saving screenshot to Anki...\" else notify-send \"Ankiconnect is not running, unable to save screenshot to Anki card.\" fi rm \" $tmp_file .jpg\" How to record audio to Anki Save this shell script to your Deck, keep it somewhere you'll remember. Calling this script will start recording audio, calling it again will stop recording and save the audio clip to the latest Anki note. Likewise, with thanks to Xythh for 99% of the code. record_audio.sh #!/bin/sh # Version 1.2 # script taken from https://gist.github.com/xythh/aab65a301a001ef6107cd54a360d4453 with minor edits # shoutout to https://gist.github.com/Cephian/f849e326e3522be9a4386b60b85f2f23 for the original script, # https://github.com/xythh/ added the ankiConnect functionality # # toggle record computer audio (run once to start, run again to stop) # # dependencies: ffmpeg, pulseaudio, curl # # for Steam deck: use python (or perl) instead of bc (since bc is not installed by default) # # # where recording gets saved, gets deleted after being imported to anki DIRECTORY = \"/home/deck/.var/app/net.ankiweb.Anki/\" FORMAT = \"mp3\" # ogg or mp3 # cut file since it glitches a bit at the end sometimes #CUT_DURATION=\"0.1\" CUT_DURATION = \"0\" #port used by ankiconnect ankiConnectPort = \"8765\" # gets the newest created card, so make sure to create the card first with yomichan newestNoteId = $( curl -s localhost: $ankiConnectPort -X POST -d '{\"action\": \"findNotes\", \"version\": 6, \"params\": { \"query\": \"is:new\"}}' | jq '.result[-1]' ) #Audio field name audioFieldName = \"SentenceAudio\" #if there is no newest note, you either have a complete empty anki or ankiconnect isn't running if [ \" $newestNoteId \" = \"\" ] ; then notify-send \"anki connect not found\" exit 1 fi if pgrep -f \"parec\" ; then pkill -f \"parec\" else time = $( date +%s ) name = \" $DIRECTORY / $time \" wav_file = \" $name .wav\" out_file = \" $name . $FORMAT \" if ! [ -d \" $DIRECTORY \" ] ; then mkdir \" $DIRECTORY \" fi notify-send -t 1000 \"Audio recording started\" #timeout 1m arecord -t wav -f cd \"$wav_file\" # just grabs last running source... may not always work if your pulseaudio setup is complicated if ! timeout 1m parec -d \" $( pactl list sinks | grep -B1 'State: RUNNING' | sed -nE 's/Sink #(.*)/\\1/p' | tail -n 1 ) \" --file-format = wav \" $wav_file \" ; then notify-send \"Error recording \" \"most likely no audio playing\" rm \" $wav_file \" exit 1 fi input_duration = $( ffprobe -v error -select_streams a:0 -show_entries stream = duration -of default = noprint_wrappers = 1 :nokey = 1 \" $wav_file \" ) # output_duration=$(echo \"$input_duration\"-\"$CUT_DURATION\" | bc) output_duration = ` python -c \"print( $input_duration - $CUT_DURATION )\" ` # encode file and delete OG if [ $FORMAT = \"ogg\" ] ; then ffmpeg -i \" $wav_file \" -vn -codec:a libvorbis -b:a 64k -t \" $output_duration \" \" $out_file \" elif [ $FORMAT = \"mp3\" ] ; then ffmpeg -i \" $wav_file \" -vn -codec:a libmp3lame -qscale:a 1 -t \" $output_duration \" \" $out_file \" else notify-send \"Record Error\" \"Unknown format $FORMAT \" fi rm \" $wav_file \" # Update newest note with recorded audio curl -s localhost: $ankiConnectPort -X POST -d '{ \"action\": \"updateNoteFields\", \"version\": 6, \"params\": { \"note\": { \"id\": ' \" $newestNoteId \" ', \"fields\": { \"' $audioFieldName '\": \"\" }, \"audio\": [{ \"path\": \"' \" $out_file \" '\", \"filename\": \"' \" $time \" '.' $FORMAT '\", \"fields\": [ \"' $audioFieldName '\" ] }] } } }' # opens changed note, comment if you don't want it. # curl -s localhost:$ankiConnectPort -X POST -d '{ # \"action\": \"guiBrowse\", # \"version\": 6, # \"params\": { # \"query\": \"nid:'\"$newestNoteId\"'\" # } # }' notify-send -t 1000 \"Audio recording copied\" rm \" $out_file \" fi Adding keyboard shortcuts to call the screenshot and record audio scripts Open the keyboard shortcut settings from the start menu. (easiest way is to type to find it) Click on Custom Shortcuts on the left. Click Edit -> New -> Global Shortcut -> Command/URL Rename it, eg. to \"Anki screenshot\" Edit the trigger to a shortcut key combo (you'll need to map this to a controller button later). I use Alt+Shift+C for screenshot and Alt+Shift+A for audio recording, but this is totally up to you, just pick something unlikely to clash with anything else in-game or with other software. Edit the action to the screenshot script you saved earlier. Put the path of the script in. (Reminder: if you move the file, you'll have to edit this shortcut.) Repeat steps #3-6 for the script to record audio. Mapping the shortcuts and other actions to controller buttons You'll want to map controller buttons to actions we need when mining. If you're launching the game through Steam, you'll need to set up both the desktop and also game-specific configs, as the latter will apply when the game is in focus. Desktop controller config: - Alt + tab - mine word (Alt+E) - replay Yomichan audio Game controller config - you'll need to do this for every game. Map the shortcut triggers you set up earlier: - save screenshot to card - start/stop recording audio and save to card","title":"Mining to Anki"},{"location":"deck-mining/mining/#mining","text":"","title":"Mining"},{"location":"deck-mining/mining/#how-to-save-screenshots-to-anki","text":"Save this shell script to your Deck, keep it somewhere you'll remember. Calling this script will capture the active window and save it to the latest Anki note, and display a notification (depending on your notification settings, you may not see it when in-game). With thanks to Xythh whom I got the code snippet from and just made minor edits to work on the Deck. ss_window.sh #!/bin/sh ### capture screnshot with spectacle #ss_dir=\"/home/deck/Pictures/Screenshots/for_anki\" time = $( date +%Y-%m-%d-%H-%M-%S ) #tmp_file=${ss_dir}/${time} tmp_file = \"/home/deck/.var/app/net.ankiweb.Anki/ $time \" spectacle --background --activewindow --nonotify --output $tmp_file .jpg ### import to anki. Code taken from https://gist.github.com/xythh/96796571baa850783a0b49f4d325e5b2 with minor edits ankiConnectPort = \"8765\" pictureField = \"Picture\" # This gets your notes marked as new and returns the newest one. newestNoteId = $( curl -s localhost: $ankiConnectPort -X POST -d '{\"action\": \"findNotes\", \"version\": 6, \"params\": { \"query\": \"is:new\"}}' | jq '.result[-1]' ) # if anki connect is running it will return your latest note id, and the following code will run, if anki connect is not running a notification pops up. if [ \" $newestNoteId \" ! = \"\" ] ; then curl -s localhost: $ankiConnectPort -X POST -d '{ \"action\": \"updateNoteFields\", \"version\": 6, \"params\": { \"note\": { \"id\": ' \" $newestNoteId \" ', \"fields\": { \"' $pictureField '\": \"\" }, \"picture\": [{ \"path\": \"' \" $tmp_file \" '.jpg\", \"filename\": \"paste-' \" $time \" '.jpg\", \"fields\": [ \"' $pictureField '\" ] }] } } }' notify-send \"Saving screenshot to Anki...\" else notify-send \"Ankiconnect is not running, unable to save screenshot to Anki card.\" fi rm \" $tmp_file .jpg\"","title":"How to save screenshots to Anki"},{"location":"deck-mining/mining/#how-to-record-audio-to-anki","text":"Save this shell script to your Deck, keep it somewhere you'll remember. Calling this script will start recording audio, calling it again will stop recording and save the audio clip to the latest Anki note. Likewise, with thanks to Xythh for 99% of the code. record_audio.sh #!/bin/sh # Version 1.2 # script taken from https://gist.github.com/xythh/aab65a301a001ef6107cd54a360d4453 with minor edits # shoutout to https://gist.github.com/Cephian/f849e326e3522be9a4386b60b85f2f23 for the original script, # https://github.com/xythh/ added the ankiConnect functionality # # toggle record computer audio (run once to start, run again to stop) # # dependencies: ffmpeg, pulseaudio, curl # # for Steam deck: use python (or perl) instead of bc (since bc is not installed by default) # # # where recording gets saved, gets deleted after being imported to anki DIRECTORY = \"/home/deck/.var/app/net.ankiweb.Anki/\" FORMAT = \"mp3\" # ogg or mp3 # cut file since it glitches a bit at the end sometimes #CUT_DURATION=\"0.1\" CUT_DURATION = \"0\" #port used by ankiconnect ankiConnectPort = \"8765\" # gets the newest created card, so make sure to create the card first with yomichan newestNoteId = $( curl -s localhost: $ankiConnectPort -X POST -d '{\"action\": \"findNotes\", \"version\": 6, \"params\": { \"query\": \"is:new\"}}' | jq '.result[-1]' ) #Audio field name audioFieldName = \"SentenceAudio\" #if there is no newest note, you either have a complete empty anki or ankiconnect isn't running if [ \" $newestNoteId \" = \"\" ] ; then notify-send \"anki connect not found\" exit 1 fi if pgrep -f \"parec\" ; then pkill -f \"parec\" else time = $( date +%s ) name = \" $DIRECTORY / $time \" wav_file = \" $name .wav\" out_file = \" $name . $FORMAT \" if ! [ -d \" $DIRECTORY \" ] ; then mkdir \" $DIRECTORY \" fi notify-send -t 1000 \"Audio recording started\" #timeout 1m arecord -t wav -f cd \"$wav_file\" # just grabs last running source... may not always work if your pulseaudio setup is complicated if ! timeout 1m parec -d \" $( pactl list sinks | grep -B1 'State: RUNNING' | sed -nE 's/Sink #(.*)/\\1/p' | tail -n 1 ) \" --file-format = wav \" $wav_file \" ; then notify-send \"Error recording \" \"most likely no audio playing\" rm \" $wav_file \" exit 1 fi input_duration = $( ffprobe -v error -select_streams a:0 -show_entries stream = duration -of default = noprint_wrappers = 1 :nokey = 1 \" $wav_file \" ) # output_duration=$(echo \"$input_duration\"-\"$CUT_DURATION\" | bc) output_duration = ` python -c \"print( $input_duration - $CUT_DURATION )\" ` # encode file and delete OG if [ $FORMAT = \"ogg\" ] ; then ffmpeg -i \" $wav_file \" -vn -codec:a libvorbis -b:a 64k -t \" $output_duration \" \" $out_file \" elif [ $FORMAT = \"mp3\" ] ; then ffmpeg -i \" $wav_file \" -vn -codec:a libmp3lame -qscale:a 1 -t \" $output_duration \" \" $out_file \" else notify-send \"Record Error\" \"Unknown format $FORMAT \" fi rm \" $wav_file \" # Update newest note with recorded audio curl -s localhost: $ankiConnectPort -X POST -d '{ \"action\": \"updateNoteFields\", \"version\": 6, \"params\": { \"note\": { \"id\": ' \" $newestNoteId \" ', \"fields\": { \"' $audioFieldName '\": \"\" }, \"audio\": [{ \"path\": \"' \" $out_file \" '\", \"filename\": \"' \" $time \" '.' $FORMAT '\", \"fields\": [ \"' $audioFieldName '\" ] }] } } }' # opens changed note, comment if you don't want it. # curl -s localhost:$ankiConnectPort -X POST -d '{ # \"action\": \"guiBrowse\", # \"version\": 6, # \"params\": { # \"query\": \"nid:'\"$newestNoteId\"'\" # } # }' notify-send -t 1000 \"Audio recording copied\" rm \" $out_file \" fi","title":"How to record audio to Anki"},{"location":"deck-mining/mining/#adding-keyboard-shortcuts-to-call-the-screenshot-and-record-audio-scripts","text":"Open the keyboard shortcut settings from the start menu. (easiest way is to type to find it) Click on Custom Shortcuts on the left. Click Edit -> New -> Global Shortcut -> Command/URL Rename it, eg. to \"Anki screenshot\" Edit the trigger to a shortcut key combo (you'll need to map this to a controller button later). I use Alt+Shift+C for screenshot and Alt+Shift+A for audio recording, but this is totally up to you, just pick something unlikely to clash with anything else in-game or with other software. Edit the action to the screenshot script you saved earlier. Put the path of the script in. (Reminder: if you move the file, you'll have to edit this shortcut.) Repeat steps #3-6 for the script to record audio.","title":"Adding keyboard shortcuts to call the screenshot and record audio scripts"},{"location":"deck-mining/mining/#mapping-the-shortcuts-and-other-actions-to-controller-buttons","text":"You'll want to map controller buttons to actions we need when mining. If you're launching the game through Steam, you'll need to set up both the desktop and also game-specific configs, as the latter will apply when the game is in focus. Desktop controller config: - Alt + tab - mine word (Alt+E) - replay Yomichan audio Game controller config - you'll need to do this for every game. Map the shortcut triggers you set up earlier: - save screenshot to card - start/stop recording audio and save to card","title":"Mapping the shortcuts and other actions to controller buttons"},{"location":"deck-mining/resources/","text":"","title":"Resources"},{"location":"deck-mining/runWin/","text":"Running Windows on the Steam Deck For when something really cannot work in Linux, or you're lazy to fiddle around with Lutris/Bottle/proton settings to get a VN working. Or if a texthook only seems to work in Windows (Trails of Cold Steel Agent hook, for example). There are a few options: 1. in SteamOS, run Windows as a virtual machine (using Boxes for example) 2. dual-boot Windows from a SD card. Recommended if you're testing only and not for long-term use, as there's a high likelihood the SD card will fail earlier. Also the performance is going to be bad for games in general. 3. dual-boot Windows from the internal SSD (or an external SSD). This is the option I recommend. Follow this guide: Bald Sealion's Steam Deck Ultimate Windows Guide Tools on Windows There are some tools I did not recommend in the main guide as the installation is a pain in Linux. If you're using Windows, you can consider using these tools: 1. YomiNinja for OCR 2. JL as an alternative to texthook pages. This overlays the text directly on top of the game window. Limitation: it supports mining to Anki, but not handlebars so you might not be able to use fancy Anki card templates that you use with Yomitan on a browser. 3. ShareX is an essential tool, you can get screenshots and record audio easily.","title":"Run Windows"},{"location":"deck-mining/runWin/#running-windows-on-the-steam-deck","text":"For when something really cannot work in Linux, or you're lazy to fiddle around with Lutris/Bottle/proton settings to get a VN working. Or if a texthook only seems to work in Windows (Trails of Cold Steel Agent hook, for example). There are a few options: 1. in SteamOS, run Windows as a virtual machine (using Boxes for example) 2. dual-boot Windows from a SD card. Recommended if you're testing only and not for long-term use, as there's a high likelihood the SD card will fail earlier. Also the performance is going to be bad for games in general. 3. dual-boot Windows from the internal SSD (or an external SSD). This is the option I recommend. Follow this guide: Bald Sealion's Steam Deck Ultimate Windows Guide","title":"Running Windows on the Steam Deck"},{"location":"deck-mining/runWin/#tools-on-windows","text":"There are some tools I did not recommend in the main guide as the installation is a pain in Linux. If you're using Windows, you can consider using these tools: 1. YomiNinja for OCR 2. JL as an alternative to texthook pages. This overlays the text directly on top of the game window. Limitation: it supports mining to Anki, but not handlebars so you might not be able to use fancy Anki card templates that you use with Yomitan on a browser. 3. ShareX is an essential tool, you can get screenshots and record audio easily.","title":"Tools on Windows"},{"location":"deck-mining/setupIntro/","text":"Setup Introduction Unless otherwise specified, all the setup and usage will be in desktop mode. To make things simple, I'll stick to using either flatpaks from the Discover app, or software that are easily installed with scripts. There are a few components to the gaming immersion flow: the game itself (obviously) a tool to extract text from the game as you play (Textractor/Agent/OCR tools etc) something to display the extracted text (typically in a browser) something to look up the vocab in a dictionary (or a few of them at once) (optional) mine to Anki (including saving screenshots and audio) for revision study later Starting setup If you're in gaming mode, switch over to desktop mode. (Press the \"Steam\" button -> power -> switch to desktop mode) Follow the steps in the next sections. Basic tools are a must; for the rest, you can pick only the ones you use. If you're not planning on mining to Anki, you can follow the steps to extract text/OCR and ignore the parts about Anki and Ankiconnect.","title":"Setup Introduction"},{"location":"deck-mining/setupIntro/#setup-introduction","text":"Unless otherwise specified, all the setup and usage will be in desktop mode. To make things simple, I'll stick to using either flatpaks from the Discover app, or software that are easily installed with scripts. There are a few components to the gaming immersion flow: the game itself (obviously) a tool to extract text from the game as you play (Textractor/Agent/OCR tools etc) something to display the extracted text (typically in a browser) something to look up the vocab in a dictionary (or a few of them at once) (optional) mine to Anki (including saving screenshots and audio) for revision study later","title":"Setup Introduction"},{"location":"deck-mining/setupIntro/#starting-setup","text":"If you're in gaming mode, switch over to desktop mode. (Press the \"Steam\" button -> power -> switch to desktop mode) Follow the steps in the next sections. Basic tools are a must; for the rest, you can pick only the ones you use. If you're not planning on mining to Anki, you can follow the steps to extract text/OCR and ignore the parts about Anki and Ankiconnect.","title":"Starting setup"},{"location":"deck-mining/setupTools/","text":"Tools To extract text as you play the game If you know what the game needs, you can just get that. Or grab them all to be well-prepared for a variety of games. Textractor Download Textractor here . You can also get the latest unofficial alpha build from this thread that has updates and should support more games. Unzip and keep it in a folder you remember. We'll need this path later. Agent Download Agent here . Get both the Windows and Linux versions. Unzip them and keep them in a folder you remember, we'll need the paths later. I personally don't use their OCR server, but other OCR tools below. OCR - have not personally tried Some options: owocr YomiNinja - for advanced Linux users (you need to know what you're doing with pacman). This tool is still fast-evolving and currently installation on SteamOS (Linux) is still a bit more complicated (and there's a risk of breaking SteamOS with conflicting dependencies). You can follow news updates on their Patreon to get a sneak peek of the upcoming features. I personally haven't installed YomiNinja on SteamOS, so no guarantees or help there. To display and look up text A browser that supports Yomitan extension (eg. Firefox, Chrome, Chromium browsers) I installed flatpaks through the Discover store. Yomitan extension Download the extension from your respective browser store, and refer to the Yomitan main page for instructions on migrating from Yomichan/setting up etc. If you already have a working Yomichan/Yomitan setup on another device, you can export the dictionaries and settings, and import on the Steam Deck. If you're starting from scratch and want a quick setup, you can consider using Xelieu's Lazy Guide (I highly recommend this guide as a whole as well.) A browser texthook page Pick one you like. I recommend pages that use websocket instead of relying on clipboard inserter (old and inferior method): exSTATic has historical stats visualization in addition to the texthook page. Remember to install the TextractorSender dll as well as listed in the instructions. Renji-XD's texthooker-ui page . Also install a websocket hook (eg. textractor-websocket or TextractorSender). To mine vocab to Anki Anki Install Anki from Discover store. Anki addons Install Ankiconnect . You'll need this to add Anki cards from Yomitan. Mining with Yomitan Make sure your Yomitan settings are correct and it's able to see the Anki deck you'll add cards to, all fields are correct, etc. Optional: offline and more audio sources for Yomitan Follow the guide here to enable offline and more audio sources for Yomitan. Note: by default, this uses Anki to run, but you can also host it locally using Python 3.9 or above. Also, this will take up ~2.5 to 5GB of disk space depending on the audio format you choose, please ensure you have enough space.","title":"Tools"},{"location":"deck-mining/setupTools/#tools","text":"","title":"Tools"},{"location":"deck-mining/setupTools/#to-extract-text-as-you-play-the-game","text":"If you know what the game needs, you can just get that. Or grab them all to be well-prepared for a variety of games.","title":"To extract text as you play the game"},{"location":"deck-mining/setupTools/#textractor","text":"Download Textractor here . You can also get the latest unofficial alpha build from this thread that has updates and should support more games. Unzip and keep it in a folder you remember. We'll need this path later.","title":"Textractor"},{"location":"deck-mining/setupTools/#agent","text":"Download Agent here . Get both the Windows and Linux versions. Unzip them and keep them in a folder you remember, we'll need the paths later. I personally don't use their OCR server, but other OCR tools below.","title":"Agent"},{"location":"deck-mining/setupTools/#ocr-have-not-personally-tried","text":"Some options: owocr YomiNinja - for advanced Linux users (you need to know what you're doing with pacman). This tool is still fast-evolving and currently installation on SteamOS (Linux) is still a bit more complicated (and there's a risk of breaking SteamOS with conflicting dependencies). You can follow news updates on their Patreon to get a sneak peek of the upcoming features. I personally haven't installed YomiNinja on SteamOS, so no guarantees or help there.","title":"OCR - have not personally tried"},{"location":"deck-mining/setupTools/#to-display-and-look-up-text","text":"","title":"To display and look up text"},{"location":"deck-mining/setupTools/#a-browser-that-supports-yomitan-extension-eg-firefox-chrome-chromium-browsers","text":"I installed flatpaks through the Discover store.","title":"A browser that supports Yomitan extension (eg. Firefox, Chrome, Chromium browsers)"},{"location":"deck-mining/setupTools/#yomitan-extension","text":"Download the extension from your respective browser store, and refer to the Yomitan main page for instructions on migrating from Yomichan/setting up etc. If you already have a working Yomichan/Yomitan setup on another device, you can export the dictionaries and settings, and import on the Steam Deck. If you're starting from scratch and want a quick setup, you can consider using Xelieu's Lazy Guide (I highly recommend this guide as a whole as well.)","title":"Yomitan extension"},{"location":"deck-mining/setupTools/#a-browser-texthook-page","text":"Pick one you like. I recommend pages that use websocket instead of relying on clipboard inserter (old and inferior method): exSTATic has historical stats visualization in addition to the texthook page. Remember to install the TextractorSender dll as well as listed in the instructions. Renji-XD's texthooker-ui page . Also install a websocket hook (eg. textractor-websocket or TextractorSender).","title":"A browser texthook page"},{"location":"deck-mining/setupTools/#to-mine-vocab-to-anki","text":"","title":"To mine vocab to Anki"},{"location":"deck-mining/setupTools/#anki","text":"Install Anki from Discover store.","title":"Anki"},{"location":"deck-mining/setupTools/#anki-addons","text":"Install Ankiconnect . You'll need this to add Anki cards from Yomitan.","title":"Anki addons"},{"location":"deck-mining/setupTools/#mining-with-yomitan","text":"Make sure your Yomitan settings are correct and it's able to see the Anki deck you'll add cards to, all fields are correct, etc.","title":"Mining with Yomitan"},{"location":"deck-mining/setupTools/#optional-offline-and-more-audio-sources-for-yomitan","text":"Follow the guide here to enable offline and more audio sources for Yomitan. Note: by default, this uses Anki to run, but you can also host it locally using Python 3.9 or above. Also, this will take up ~2.5 to 5GB of disk space depending on the audio format you choose, please ensure you have enough space.","title":"Optional: offline and more audio sources for Yomitan"},{"location":"deck-mining/tips/","text":"Tips Misc tips Adjust zoom factor of Yomitan and your texthook page. I like to use between 125 - 150%. There are times (especially when setting up) where it'll be much easier if you have a keyboard and mouse. A few options: Use bluetooth kb+m Get a usb-c dock and connect your kb+m Remote desktop (either through Steam remote play or other software) window mode for games are more stable than fullscreen since we have to alt+tab often. Use frameless window option if the game supports it. back buttons are good candidates to map for our window switching, OCR, and mining actions map single click and moving the cursor to separate trackpads for easier click and drag (if you're attempting OCR where you have to drag a region) you can map double click by using extra command of type \"start press\" and put a delay disable mouse in the game if supported to avoid camera moving around or accidentally advancing text when grabbing a screenshot for OCR. Eg. Senpatcher for Sen no Kiseki can disable mouse in-game Transferring files Options: - SFTP (eg, WinSCP or FileZilla on Windows) - recommended as it was the easiest for me. - KDE Connect (only for small files, it fails for files larger than a couple of GB for me) - Warpinator (failed a few times on me) Others I know of but didn't use: - Syncthing - sshfs - deckMTP - cloud services (eg, Google Drive, Dropbox, etc) - USB drives or SD cards (note: some filesystem formats may not be recognized by Linux, or Windows)","title":"Misc Tips"},{"location":"deck-mining/tips/#tips","text":"","title":"Tips"},{"location":"deck-mining/tips/#misc-tips","text":"Adjust zoom factor of Yomitan and your texthook page. I like to use between 125 - 150%. There are times (especially when setting up) where it'll be much easier if you have a keyboard and mouse. A few options: Use bluetooth kb+m Get a usb-c dock and connect your kb+m Remote desktop (either through Steam remote play or other software) window mode for games are more stable than fullscreen since we have to alt+tab often. Use frameless window option if the game supports it. back buttons are good candidates to map for our window switching, OCR, and mining actions map single click and moving the cursor to separate trackpads for easier click and drag (if you're attempting OCR where you have to drag a region) you can map double click by using extra command of type \"start press\" and put a delay disable mouse in the game if supported to avoid camera moving around or accidentally advancing text when grabbing a screenshot for OCR. Eg. Senpatcher for Sen no Kiseki can disable mouse in-game","title":"Misc tips"},{"location":"deck-mining/tips/#transferring-files","text":"Options: - SFTP (eg, WinSCP or FileZilla on Windows) - recommended as it was the easiest for me. - KDE Connect (only for small files, it fails for files larger than a couple of GB for me) - Warpinator (failed a few times on me) Others I know of but didn't use: - Syncthing - sshfs - deckMTP - cloud services (eg, Google Drive, Dropbox, etc) - USB drives or SD cards (note: some filesystem formats may not be recognized by Linux, or Windows)","title":"Transferring files"}]}